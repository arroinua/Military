/* 
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

{
  
/*
 * Method: "getExtensions"
 * 
 * Example:
 * -> {"method":"getExtensions"}
 * <- {"result":{ ["ext":"101", "oid":"234254761347", "name":"John Smith", "kind":"user", "groupid":"2364574722245", "state":1 ],[ ... ], ... } }
 * 
 * Parameters:
 *  none
 *          
 *  result: список номеров
 *          "ext":      номер
 *          "name":     имя объекта
 *          "kind":     тип объекта:
 *                      "user" - пользователь
 *                      "phone" - телефонный аппарат
 *                      "unit"  - группа телефонов
 *                      "hunting" - группа поиска
 *                      "icd" - группа обслуживания входящего вызова
 *                      "application" - приложение
 *                      "conference" -  конференц-группа
 *                      
 *          "groupid":  идентификатор группы (для объектов типа "user" или "phone")
 *          
 *          "state":    состояние (для объектов типа "user" или "phone")
 *                      0 - свободен
 *                      1 - исходящий вызов
 *                      2 - входящий вызов
 *                      3 - соединен
 *                      4 - включена функция "не беспокоить"
 *                      5 - не зарегистрирован
 *                      6 - установлена переадресация на внешний номер
 */
 "getExtensions": {
    "type":                 "method",
    
    "params": {
    },
    
    "result": [
        {
            "ext":          "string",
            "name":         "string",
            "kind":         "string",
            "groupid":      "string",
            "state":        "number",
        }
    ]
},


/*
 * Method: "getGroups"
 * 
 * Example:
 * 
 * -> { "method": "getGroups" }
 * <- { "result": { [ "oid": "2364574722245", "kind": "unit", "name": "Marketing Department" ], [ "oid": "1462547254547", "kind": "users", "name": "IT Department" ] } }
 * 
 * 
 *  params: none
 *          
 *  result: список групп
 *          "oid":      идентификатор группы
 *          "name"      имя группы
 *          "kind"      тип группы
 *                      "unit": группа телефонов
 *                      "users":группа пользователей
 *          "parentid": идентификатор вышестоящей группы (если есть)
 *          
 */
"getGroups": {
    "type":                 "method",
    
    "params": {
    },
    
    "result": [
        {
        "oid":              "string",
        "name":             "string",
        "kind":             "string", // [  "users", "unit" ]
        "parentid":         "string",
        }
    ]
},

/*
 *  Method "getProfile"
 *  Получить параметры своего профиля
 *
 *  params: none
 *          
 *  result: таблица параметров
 *          "name":     имя
 *          "number":   номер
 *          "display":  имя, отображаемое на дисплее телефона
 *          "enabled":  состояние (false - выключен администратором)
 *          "groupid":  идентификатор группы
 *          "followme": номер телефона, на который адресуются звонки
 *          "features": настройки функций
 *                      "lock":     запрет/разрешение изменения настроек с телефонного аппарата
 *                      "clir":     запрет/разрешение отображения своего номера при звонке
 *                      "dnd":      функция "не беспокоить"
 *                      "fwdall":   включение/выключение безусловной переадресации
 *                      "fwdbusy":  включение/выключение переадресации по "занято"
 *                      "fwdnans":  включение/выключение переадресации по неответу
 *                      "fwdnreg":  включение/выключение переадресации при отсутствии регистрации
 *                      "pickupdeny":   запрет/разрешение перехвата вызова
 *                      "busyoverdeny": запрет/разрешение вторжения в разговор
 *                      "monitordeny":  запрет/разрешение прослушивания разговора
 *                      "callwaiting":  включение/выключение функции "Ожидающий вызов"
 *                      "huntbusy":     включение/выключение функции поиска, если номер занят
 *                      "huntnans":     включение/выключение функции поиска при неответе
 *                      "huntnreg":     включение/выключение функции поиска при отсутствии регистрации
 *                      "voicemail":    включение/выключение функции голосовой почты
 *                      "fwdallnumber": номер для безусловной переадресации
 *                      "fwdbusynumber":номер для переадресации по "занято"
 *                      "fwdnansnumber":номер для переадресации по неответу
 *                      "fwdnregnumber":номер для переадресации при отсутствии регистрации
 *                      "fwdtimeout":   таймаут для переадресации по неответу (в секундах)
 *                      "huntingnumbers": список номеров для поиска
 */
 "getProfile": {
    "type":                 "method",
    
    "params": {
    },
    
    "result": {
        "name":             "string",
        "number":           "string",
        "display":          "string",
        "enabled":          "boolean",
        "groupid":          "string",
        "followme":         "string",
        "features": {
            "lock":         "boolean",
            "clir":         "boolean",
            "dnd":          "boolean",
            "fwdall":       "boolean",
            "fwdbusy":      "boolean",
            "fwdnans":      "boolean",
            "fwdnreg":      "boolean",
            "pickupdeny":   "boolean",
            "busyoverdeny": "boolean" ,
            "monitordeny":  "boolean",
            "callwaiting":  "boolean",
            "huntbusy":     "boolean",
            "huntnans":     "boolean",
            "huntnreg":     "boolean",
            "voicemail":    "boolean",
            "fwdallnumber":     "string",
            "fwdbusynumber":    "string",
            "fwdnansnumber":    "string",
            "fwdnregnumber":    "string",
            "fwdtimeout":       "number",
            "huntingnumbers":   ["string"]
        },
    }
 },
        

/*
 *  Method "setProfile"
 *  Установить параметры своего профиля
 *          
 *  params: таблица параметров
 *          "pin":      pin код для доступа к функциям с телефонного аппарата
 *          "display":  имя, отображаемое на дисплее телефона
 *          "followme": номер телефона, на который адресуются звонки
 *          "features": настройки функций
 *                      "lock":     запрет/разрешение изменения настроек с телефонного аппарата
 *                      "clir":     запрет/разрешение отображения своего номера при звонке
 *                      "dnd":      функция "не беспокоить"
 *                      "fwdall":   включение/выключение безусловной переадресации
 *                      "fwdbusy":  включение/выключение переадресации по "занято"
 *                      "fwdnans":  включение/выключение переадресации по неответу
 *                      "fwdnreg":  включение/выключение переадресации при отсутствии регистрации
 *                      "pickupdeny":   запрет/разрешение перехвата вызова
 *                      "busyoverdeny": запрет/разрешение вторжения в разговор
 *                      "monitordeny":  запрет/разрешение прослушивания разговора
 *                      "callwaiting":  включение/выключение функции "Ожидающий вызов"
 *                      "huntbusy":     включение/выключение функции поиска, если номер занят
 *                      "huntnans":     включение/выключение функции поиска при неответе
 *                      "huntnreg":     включение/выключение функции поиска при отсутствии регистрации
 *                      "voicemail":    включение/выключение функции голосовой почты
 *                      "fwdallnumber": номер для безусловной переадресации
 *                      "fwdbusynumber":номер для переадресации по "занято"
 *                      "fwdnansnumber":номер для переадресации по неответу
 *                      "fwdnregnumber":номер для переадресации при отсутствии регистрации
 *                      "fwdtimeout":   таймаут для переадресации по неответу (в секундах)
 *                      "huntingnumbers": список номеров для поиска
 *                      
 *  result: none
 */
 "setProfile": {
    "type":                 "method",
    
    "params": {
        "pin":              "number",
        "display":          "string",
        "followme":         "string",
        "features": {
            "lock":         "boolean",
            "clir":         "boolean",
            "dnd":          "boolean",
            "fwdall":       "boolean",
            "fwdbusy":      "boolean",
            "fwdnans":      "boolean",
            "fwdnreg":      "boolean",
            "pickupdeny":   "boolean",
            "busyoverdeny": "boolean" ,
            "monitordeny":  "boolean",
            "callwaiting":  "boolean",
            "huntbusy":     "boolean",
            "huntnans":     "boolean",
            "huntnreg":     "boolean",
            "voicemail":    "boolean",
            "fwdallnumber":     "string",
            "fwdbusynumber":    "string",
            "fwdnansnumber":    "string",
            "fwdnregnumber":    "string",
            "fwdtimeout":       "number",
            "huntingnumbers":   ["string"]
        },
    }
},

/*************************************************************************************************************
 *  Нотификация от сервера клиенту
 *************************************************************************************************************/

/* 
 * Получить список текущих соединений.
 * 
 * method:  "stateChanged"
 * 
 * params:  
 *          "ext":      номер
 *          "state":    состояние
 *                      0 - свободен
 *                      1 - исходящий вызов
 *                      2 - входящий вызов
 *                      3 - соединен
 *                      4 - включена функция "не беспокоить"
 *                      5 - не зарегистрирован
 *                      6 - установлена переадресация на внешний номер
 *                     -1 - удален
 *          
 *          "reg":      ip адрес или номер переадресации
 * 
 */

"stateChanged": {
    "type":             "indication",
    
    "params": {
        "ext":          "string",
        "state":        "number",
        "reg":          "string"
    }
},


/*************************************************************************************************************
 *  Методы админа бранча
 *************************************************************************************************************/

/* 
 * Получить список текущих соединений.
 * 
 * method:  "getCurrentCalls"
 * 
 * params:  Нет
 * 
 * result:  список текущих соединений
 *          "caller":   вызывающий номер
 *          "called":   вызываемый номер
 *          "time":     длительность соединения (только для соединенных звонков
 * 
 */

"getCurrentCalls": {
    "type":                 "method",
    
    "params": {
    },
    
    "result": [
        {
            "caller":       "string",
            "called":       "string",
            "time":         "number",
        }
    ]
},

/* 
 * Получить список соединений и загрузку по транкам.
 * 
 * method:  "getCurrentState"
 * 
 * params:  Нет
 * 
 * result:  таблица параметров:
 * 
 *          "in":       количество входящих соединений
 *          "out":      количество исходящих соединений
 *          "conn":     количество соединенных вызовов
 *          "load":     загрузка портов (в процентах)
 *          "trunks":   список транков
 *                      "id":   идентификатор транка
 *                      "name": имя транка
 *                      "in":   количество входящих соединений
 *                      "out":  количество исходящих соединений
 *                      "load": загрузка транка (в процентах)
 * 
 */

"getCurrentState": {
    "type":                 "method",
    
    "params": {
    },
    
    "result": {
        "in":               "number",
        "out":              "number",
        "conn":             "number",
        "load":             "number",       
        "trunks": [
            {
                "id":       "string",
                "name":     "string",
                "in":       "number",
                "out":      "number",
                "load":     "number",
            }
        ]
    }
},

/* 
 * Получить историю звонков.
 * 
 * method:  "getCalls"
 * 
 * params:  таблица параметров:
 *          "begin":    начальная граница выборки (в миллисекундах от 1.01.1970)
 *          "end":      конечная граница выборки (в миллисекундах от 1.01.1970)
 *          "number":   номер абонента. Если параметр отсутствует, выбираются все звонки
 *          "trunk":    имя транка
 *          "mode":     вид выборки:
 *                      0 - все звонки
 *                      1 - только соединенные звонки
 *                      2 - только внешние звонки
 *                      3 - только внешние соединенные звонки
 *          "order":    порядок выборки:
 *                      0 - по возрастанию даты
 *                      1 - по убыванию даты
 *          "limit":    максимальное число записей в выборке
 * 
 * result:  список текущих соединений
 *          "ts":       штамп времени звонка (в миллисекундах от 1.01.1970)
 *          "na":       вызывающий номер
 *          "nb":       вызываемый номер
 *          "ta":       транк входящего соединения
 *          "tb":       транк исходящего соединения
 *          "nc":       исходящий номер
 *          "cs":       код завершения (стандартный код ISDN)
 *          "td":       длительность соединения
 *          "tr":       тариф
 *          "ch":       стоимость звонка
 * 
 */

"getCalls": {
    "type":                 "method",
    
    "params": {
        "begin":            "number",
        "end":              "number",
        "number":           "string",
        "trunk":            "string",
        "mode":             "number",
        "order":            "number",
        "limit":            "number",
    },
    
    "result": [
        {
            "ts":           "number",
            "na":           "string",
            "nb":           "string",
            "ta":           "string",
            "tb":           "string",
            "nc":           "string",
            "cs":           "number",
            "td":           "number",
            "tr":           "number",
            "ch":           "number",
        }
    ]
},

/*************************************************************************************************************
 *  Нотификация от сервера клиенту
 *************************************************************************************************************/

/*
 *  Method "objectCreated"
 *  Нотификация о создании объекта
 *
 *  params: объект ["PbxExtension", "PbxGroup", "PbxApplication", "PbxConference", "RoutingTable", "Trunk"]
 */

"objectCreated": {
    "type":         "indication",
    "params": {
        "enum":     ["PbxExtension", "PbxGroup", "PbxApplication", "PbxConference", "RoutingTable", "Trunk"]
    },
},

/*
 *  Method "objectDeleted"
 *  
 *  Нотификация об удалении объекта
 *
 *  params: "oid" - идентификатор объекта
 */

"objectDeleted": {
    "type":         "indication",
    "params": {
        "oid":      "string"
    }
},

}
